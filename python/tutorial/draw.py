import matplotlib.pyplot as plt
import numpy as np

# losses = np.load("/root/libuipc/python/mesh/losses.npy")
# print("losses: ", losses)
# assert False


# [np.float64(6.3633602509023435), np.float64(4.6022257858244435), np.float64(4.523171155193513), np.float64(4.374273988577203), np.float64(4.298778070028113), np.float64(4.015452797428818), np.float64(4.088837149094232), np.float64(3.983153838032545), np.float64(3.6965820640767157), np.float64(3.758657691843628), np.float64(4.024792430368413), np.float64(3.7461254629160767), np.float64(3.9449100257924257), np.float64(3.903146992612159), np.float64(3.6383854971153937), np.float64(3.9459134752374796), np.float64(3.6869828380304925), np.float64(3.8631281110618327), np.float64(3.5564880536436236), np.float64(3.836352260744068)]
# data = [6.3633602509023435, 4.6022257858244435, 4.523171155193513, 4.374273988577203, 4.298778070028113, 4.015452797428818, 4.088837149094232, 3.983153838032545, 3.6965820640767157, 3.758657691843628, 4.024792430368413, 3.7461254629160767, 3.9449100257924257, 3.903146992612159, 3.6383854971153937, 3.9459134752374796, 3.6869828380304925, 3.8631281110618327, 3.5564880536436236, 3.836352260744068]
# [np.float64(0.000538682380074425), np.float64(0.00042528761974814207), np.float64(0.00040822876150403155), np.float64(0.0003908856622298893), np.float64(0.0003777128438002586), np.float64(0.00036756459309334973), np.float64(0.00035468765724821154), np.float64(0.0003570018000350284), np.float64(0.0003198873337739631), np.float64(0.00033456445454623055), np.float64(0.0003483969851443355), np.float64(0.0003324520123937952), np.float64(0.0003408911486293142), np.float64(0.0003416162594633963), np.float64(0.0003147554524967961), np.float64(0.00033266729046955946), np.float64(0.00032687518622016496), np.float64(0.0003189802373893461), np.float64(0.0003234287434149896), np.float64(0.0003202383239152845)]
# data = [0.000538682380074425, 0.00042528761974814207, 0.00040822876150403155, 0.0003908856622298893, 0.0003777128438002586, 0.00036756459309334973, 0.00035468765724821154, 0.0003570018000350284, 0.0003198873337739631, 0.00033456445454623055, 0.0003483969851443355, 0.0003324520123937952, 0.0003408911486293142, 0.0003416162594633963, 0.0003147554524967961, 0.00033266729046955946, 0.00032687518622016496, 0.0003189802373893461, 0.0003234287434149896, 0.0003202383239152845]

# [np.float64(18.02173900867161), np.float64(13.829518412167971), np.float64(13.423222259282701), np.float64(14.387421166515738), np.float64(14.905142117396789), np.float64(15.117617142370525), np.float64(15.521988070127284), np.float64(16.38591815563384), np.float64(16.367466842986104), np.float64(16.836315107629282), np.float64(16.919217347091895), np.float64(17.084059364120918), np.float64(17.24544251695477), np.float64(17.49113276316902), np.float64(17.6659602316148), np.float64(18.02681142630844), np.float64(18.059268028538604), np.float64(18.122670638208284), np.float64(18.189543974692675), np.float64(18.323232862403856)]
# data = [18.02173900867161, 13.829518412167971, 13.423222259282701, 14.387421166515738, 14.905142117396789, 15.117617142370525, 15.521988070127284, 16.38591815563384, 16.367466842986104, 16.836315107629282, 16.919217347091895, 17.084059364120918, 17.24544251695477, 17.49113276316902, 17.6659602316148, 18.02681142630844, 18.059268028538604, 18.122670638208284, 18.189543974692675, 18.323232862403856]
# [np.float64(1.6133421565954977), np.float64(1.5809143273661141), np.float64(1.6026736977401275), np.float64(1.586283322292255), np.float64(1.5854483457972512), np.float64(1.5830925751753204), np.float64(1.5859204316836448), np.float64(1.5935936224717842), np.float64(1.587995517698873), np.float64(1.5904677028129592), np.float64(1.589411463446222), np.float64(1.5836559703077016), np.float64(1.5769979433533128), np.float64(1.5598365971917971), np.float64(1.5785460571487175), np.float64(1.5945701236676935), np.float64(1.5727161195511137), np.float64(1.5939626374000269), np.float64(1.593381389084402), np.float64(1.6242997264724166)]
# data = [1.6133421565954977, 1.5809143273661141, 1.6026736977401275, 1.586283322292255, 1.5854483457972512, 1.5830925751753204, 1.5859204316836448, 1.5935936224717842, 1.587995517698873, 1.5904677028129592, 1.589411463446222, 1.5836559703077016, 1.5769979433533128, 1.5598365971917971, 1.5785460571487175, 1.5945701236676935, 1.5727161195511137, 1.5939626374000269, 1.593381389084402, 1.6242997264724166]

# [np.float64(17.812518440421627), np.float64(10.59167868193446), np.float64(8.662763303226), np.float64(7.658825853862396), np.float64(6.993031476824461), np.float64(6.648879358766426), np.float64(6.428212167946958), np.float64(6.176770396033448), np.float64(6.206678866398558), np.float64(6.06177424475457), np.float64(6.006986024554588), np.float64(5.885718356153228), np.float64(5.954204549350299), np.float64(5.83401065445984), np.float64(5.714520889346992), np.float64(5.681708262772927), np.float64(5.573867707373819), np.float64(5.6395903027587515), np.float64(5.64974816528041), np.float64(5.545074886209441)]
# [np.float64(0.0005486871543426602), np.float64(0.00047302102398314344), np.float64(0.0004373505457526554), np.float64(0.0004271928533552681), np.float64(0.0004150043916510065), np.float64(0.0004126654831039811), np.float64(0.00040208845535519554), np.float64(0.0003965360337919609), np.float64(0.00040713667811875554), np.float64(0.000399504951966596), np.float64(0.0003926506219115774), np.float64(0.0003976858271402743), np.float64(0.0003867169910349179), np.float64(0.00037832860533863977), np.float64(0.0003787812832062157), np.float64(0.00038931694635554044), np.float64(0.00038754986923817845), np.float64(0.00038548816999839987), np.float64(0.0003737277893698225), np.float64(0.00038546265083828283)]
# [array([1.0014693], dtype=float32), array([0.99955946], dtype=float32), array([0.9995162], dtype=float32), array([0.9994945], dtype=float32), array([0.9994651], dtype=float32), array([0.99949217], dtype=float32), array([0.999406], dtype=float32), array([0.99947345], dtype=float32), array([0.99942815], dtype=float32), array([0.99939036], dtype=float32), array([0.99945897], dtype=float32), array([0.99942905], dtype=float32), array([0.9993642], dtype=float32), array([0.9995407], dtype=float32), array([0.9994976], dtype=float32), array([0.9994367], dtype=float32), array([0.9993211], dtype=float32), array([0.9993598], dtype=float32), array([0.999425], dtype=float32), array([0.9994305], dtype=float32)]

# [np.float64(100.53241349764792), np.float64(65.59191181412555), np.float64(46.51956844219176), np.float64(35.84848117667836), np.float64(30.337035744606567), np.float64(26.269111529629868), np.float64(24.032215588314497), np.float64(21.4778222630975), np.float64(19.661453413410452), np.float64(18.44083378838284), np.float64(18.62804157810431), np.float64(17.54631351246185), np.float64(17.043475950843053), np.float64(16.963428163145057), np.float64(16.607630552419415), np.float64(16.705456173602776), np.float64(16.49691035679335), np.float64(16.12916022075813), np.float64(16.123910595295662), np.float64(15.685289891696069)]
# data = [100.53241349764792, 65.59191181412555, 46.51956844219176, 35.84848117667836, 30.337035744606567, 26.269111529629868, 24.032215588314497, 21.4778222630975, 19.661453413410452, 18.44083378838284, 18.62804157810431, 17.54631351246185, 17.043475950843053, 16.963428163145057, 16.607630552419415, 16.705456173602776, 16.49691035679335, 16.12916022075813, 16.123910595295662, 15.685289891696069]

# [array([0.1980214], dtype=float32), array([0.13930652], dtype=float32), array([0.1031613], dtype=float32), array([0.07997258], dtype=float32), array([0.06852154], dtype=float32), array([0.0608336], dtype=float32), array([0.05575468], dtype=float32), array([0.0507009], dtype=float32), array([0.04679774], dtype=float32), array([0.04396753], dtype=float32), array([0.04422426], dtype=float32), array([0.04164193], dtype=float32), array([0.04056968], dtype=float32), array([0.03981909], dtype=float32), array([0.03898403], dtype=float32), array([0.03961228], dtype=float32), array([0.03861401], dtype=float32), array([0.0378431], dtype=float32), array([0.03791155], dtype=float32), array([0.03653052], dtype=float32)]
# data = [0.1980214, 0.13930652, 0.1031613, 0.07997258, 0.06852154, 0.0608336, 0.05575468, 0.0507009, 0.04679774, 0.04396753, 0.04422426, 0.04164193, 0.04056968, 0.03981909, 0.03898403, 0.03961228, 0.03861401, 0.0378431, 0.03791155, 0.03653052]

# [array([[0.03667324]], dtype=float32), array([[0.02518019]], dtype=float32), array([[0.02118566]], dtype=float32), array([[0.01854905]], dtype=float32), array([[0.0172408]], dtype=float32), array([[0.01661617]], dtype=float32), array([[0.01597524]], dtype=float32), array([[0.01532518]], dtype=float32), array([[0.01494945]], dtype=float32), array([[0.01505297]], dtype=float32), array([[0.01464919]], dtype=float32), array([[0.01432223]], dtype=float32), array([[0.01402332]], dtype=float32), array([[0.01412071]], dtype=float32), array([[0.01376652]], dtype=float32), array([[0.01363482]], dtype=float32), array([[0.01344876]], dtype=float32), array([[0.01347182]], dtype=float32), array([[0.01328815]], dtype=float32), array([[0.01345486]], dtype=float32)]
# data = [0.03667324, 0.02518019, 0.02118566, 0.01854905, 0.0172408, 0.01661617, 0.01597524, 0.01532518, 0.01494945, 0.01505297, 0.01464919, 0.01432223, 0.01402332, 0.01412071, 0.01376652, 0.01363482, 0.01344876, 0.01347182, 0.01328815, 0.01345486]
# [array([[0.05866936]], dtype=float32), array([[0.02894863]], dtype=float32), array([[0.01969722]], dtype=float32), array([[0.01663734]], dtype=float32), array([[0.01507675]], dtype=float32), array([[0.01412906]], dtype=float32), array([[0.01314892]], dtype=float32), array([[0.01253531]], dtype=float32), array([[0.01187048]], dtype=float32), array([[0.01123149]], dtype=float32), array([[0.01098994]], dtype=float32), array([[0.01065381]], dtype=float32), array([[0.01053015]], dtype=float32), array([[0.01018443]], dtype=float32), array([[0.00982733]], dtype=float32), array([[0.0098188]], dtype=float32), array([[0.00961693]], dtype=float32), array([[0.00938395]], dtype=float32), array([[0.00937535]], dtype=float32), array([[0.0093586]], dtype=float32)]
# data = [0.05866936, 0.02894863, 0.01969722, 0.01663734, 0.01507675, 0.01412906, 0.01314892, 0.01253531, 0.01187048, 0.01123149, 0.01098994, 0.01065381, 0.01053015, 0.01018443, 0.00982733, 0.0098188, 0.00961693, 0.00938395, 0.00937535, 0.0093586]

# [array([0.00789833]), array([0.00436058]), array([0.00388778]), array([0.00363523]), array([0.00345174]), array([0.00335766]), array([0.00328856]), array([0.00325096]), array([0.00312542]), array([0.00314155]), array([0.00311134]), array([0.00303084]), array([0.00306469]), array([0.00299234]), array([0.00299595]), array([0.00296084]), array([0.00293272]), array([0.00291105]), array([0.00289345]), array([0.00282712])]
# data = [0.00789833, 0.00436058, 0.00388778, 0.00363523, 0.00345174, 0.00335766, 0.00328856, 0.00325096, 0.00312542, 0.00314155, 0.00311134, 0.00303084, 0.00306469, 0.00299234, 0.00299595, 0.00296084, 0.00293272, 0.00291105, 0.00289345, 0.00282712]

# [array([0.00894105]), array([0.00534127]), array([0.00496767]), array([0.00475087]), array([0.00466003]), array([0.00451882]), array([0.00444884]), array([0.00439915]), array([0.00424741]), array([0.00418015]), array([0.00411611]), array([0.00407726]), array([0.00409694]), array([0.00405289]), array([0.00401284]), array([0.0040175]), array([0.00395904]), array([0.00388486]), array([0.00395649]), array([0.00407456])]
data = [0.00894105, 0.00534127, 0.00496767, 0.00475087, 0.00466003, 0.00451882, 0.00444884, 0.00439915, 0.00424741, 0.00418015, 0.00411611, 0.00407726, 0.00409694, 0.00405289, 0.00401284, 0.0040175, 0.00395904, 0.00388486, 0.00395649, 0.00407456]
# 创建折线图
plt.plot(data)

# 设置标题和标签
plt.title("")
plt.xlabel("iteration")
plt.ylabel("loss")

# 显示图表
plt.savefig("loss.png")
